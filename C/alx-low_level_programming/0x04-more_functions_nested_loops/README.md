I shall revisit and deal with more nested loops and functions here.
